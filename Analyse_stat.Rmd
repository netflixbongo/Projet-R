---
title: "Statistique"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 1- Presentation du jeu de donnees

     Tableau de donnees

```{r}
library(readxl)
my_data <- read_excel(paste0(getwd(),"/StockX database.xlsx"), sheet = "StockX database - Ventes")
my_data
```
      Structure du tableau

```{r}
#Nombre de ligne
nrow(my_data)
```
```{r}
#Nombre de colonne
ncol(my_data)
```
```{r}
#Dimension(ligne et colonne)
dim(my_data)
```

```{r}
#La fonction "names" retourne les noms des colonnes du tableau
names(my_data)
```


```{r}
#la fonction "str" renvoie un descriptif plus détaillé de la structure du tableau (liste des variables, indique leurs types)
str(my_data)
```

## 2- Analyse Univariee
        
#2-1 Analyse de variable quantitative

#2-1-1 Indicateurs de centralité

Determination des valeurs extrêmes (min, max ou range)

```{r}
min(my_data$`Shoe Size`,na.rm= TRUE)
```
```{r}
max(my_data$`Shoe Size`,na.rm= TRUE)
```
```{r}
range(my_data$`Shoe Size`,na.rm= TRUE)
```
calcule de la moyenne la fonction "mean"

```{r}
mean(my_data$`Shoe Size`,na.rm= TRUE)
```

La mediane

```{r}
median(my_data$`Shoe Size`,na.rm= TRUE)
```

#2-1-2 Indicateurs de dispersion

Permettant de mesurer si les valeurs sont regroupées ou dispersées

```{r}
max(my_data$`Shoe Size`,na.rm= TRUE) - min(my_data$`Shoe Size`,na.rm= TRUE)
```

La variance
```{r}
var(my_data$`Shoe Size`,na.rm= TRUE)
```

standard deviation
```{r}
sd(my_data$`Shoe Size`,na.rm= TRUE)
```
 
 Calcule des quartiles avec la fonction "quantile":

    -le premier quartile est la valeur pour laquelle on a 25% des observations en dessous et 75% au dessus
    -le deuxième quartile est la valeur pour laquelle on a 50% des observations en dessous et 50% au dessus
    -le troisième quartile est la valeur pour laquelle on a 75% des observations en dessous et 25% au dessus
```{r}
quantile(my_data$`Shoe Size`, prob = 0.25,na.rm= TRUE)
```
```{r}
quantile(my_data$`Shoe Size`, prob = 0.75,na.rm= TRUE)
```
La fonction "summary" pour obtenir d’un seul coup plusieurs indicateurs

```{r}
summary(my_data$`Shoe Size`)
```
#2-1-3 Representation graphique

Histogramme pour étudier la distribution des valeurs d’une variable quantitative

```{r}
hist(my_data$`Shoe Size`, col = "green",
     main = "Shoe Size",
     xlab = "Size",
     ylab = "Nombre")
```
#2-2 Analyse de variable qualiitative

#2-2-1 Triage

Un tri à plat s’obtient sous R à l’aide de la fonction "table"

```{r}
table(my_data$Brand)
```
```{r}
table(my_data$`Sneaker Name`)
```
À noter qu’on peut aussi appliquer summary à une variable qualitative. Le résultat est également le tri à plat de la variable, avec en plus le nombre de valeurs manquantes éventuelles

```{r}
summary(my_data$`Sneaker Name`)
```
Par défaut ces tris à plat sont en effectifs et ne sont pas toujours très lisibles, notamment quand on a des effectifs importants. On leur rajoute donc en général la répartition en pourcentages. Pour cela, nous allons utiliser la fonction freq de l’extension questionr, qui devra donc avoir précédemment été chargée avec library(questionr)

```{r}
library(questionr)
freq(my_data$`Sneaker Name`)
```

#2-2-2 Representation graphique

```{r}
tab <- table(my_data$`Sneaker Name`)
barplot(tab)
```
## 3- Analyse bivariee

# Croisement de deux variables

# 3-1 Tableaux croisés

Quand on veut croiser deux variables qualitatives, on fait un tableau croisé. Par exemple, si on veut croiser le Brand et le Sneaker Name :

```{r}
table(my_data$`Sneaker Name`,my_data$`Brand`)
```
Et pour les pourcentages colonne :
```{r}
tab <- table(my_data$`Sneaker Name`,my_data$`Brand`)
cprop(tab)
```

# 3-2 Test du χ²
Comme on travaille sur un échantillon et pas sur une population entière, on peut compléter ce tableau croisé par un test d’indépendance du χ². Celui-ci permet de tester, et éventuellement de rejeter, l’hypothèse d’indépendance des lignes et des colonnes du tableau, c’est à dire l’hypothèse que les écarts à l’indépendance observés seraient uniquement dus au biais d’échantillonnage.

Pour effectuer ce test, on applique la fonction 'chisq.test'.

```{r}
chisq.test(tab)
```
Le résultat nous indique trois valeurs :

- X-squared, la valeur de la statistique du χ² pour notre tableau, c’est-à-dire une “distance” entre notre tableau observé et celui attendu si les deux variables étaient indépendantes.
- df, le nombre de degrés de libertés du test, qui dépend des dimensions du tableau.
- p-value, le fameux p, qui indique la probabilité d’obtenir une valeur de la statistique du χ² au moins aussi extrême sous l’hypothèse d’indépendance.

En complément du test du χ², on peut aussi regarder les résidus de ce test pour affiner la lecture du tableau. Ceux-ci s’obtiennent avec la fonction "chisq.residuals"

```{r}
chisq.residuals(tab)
```
L’interprétation des résidus est la suivante :

- si la valeur du résidu pour une case est inférieure à -2, alors il y a une sous-représentation de cette case dans le tableau : les effectifs sont significativement plus faibles que ceux attendus sous l’hypothèse d’indépendance
- à l’inverse, si le résidu est supérieur à 2, il y a sur-représentatation de cette case
- si le résidu est compris entre -2 et 2, il n’y a pas d’écart à l’indépendance significatif

# 3-3 Representation graphique

```{r}
mosaicplot(tab)
```